(function(e){function t(){function e(){try{return new XMLHttpRequest}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){console.log("XMLHttpRequest not supported")}return null}function t(e,r){function a(e,n,r){setTimeout(function(){return i.webSocketAttemptCount?i.webSocketAttemptCount++:i.webSocketAttemptCount=1,i.webSocketAttemptCount>20?(i.webSockets=!1,void 0):(t(e,r),void 0)},n||100)}if(!i.webSockets)return l(e),void 0;if(!s.webSocket){var c=i.socketProto+"://"+i.socketHost;try{s.webSocket=new WebSocket(c),s.webSocket.onclose=function(e){e.wasClean||(i.webSocketBadCloseCount?i.webSocketBadCloseCount++:i.webSocketBadCloseCount=1,i.webSocketBadCloseCount>2&&(s.webSocket&&(s.webSocket.close(),s.webSocket=null),i.webSockets=!1))},$TB&&$TB.Event&&$TB.Event.Middleware.when($TB.Event.on(window,"beforeunload",function(){s.webSocket&&s.webSocket.close()})).use($TB.Event.Middleware.times,1)}catch(u){i.webSockets=!1}return a(e,null,r),void 0}try{$TB.needWSIP()&&(n({type:"heartbeat",data:{c:o.c,ua:navigator.userAgent.substr(0,150),w:o.w}}),$TB.setWSIP())}catch(d){}return s.webSocket?s.webSocket.readyState!==s.webSocket.OPEN?(s.webSocket.readyState===s.webSocket.CLOSED&&(s.webSocket=null),s.webSocket&&s.webSocket.readyState!==s.webSocket.CONNECTING?a(e,500,r):a(e,null,r),void 0):(s.webSocket.send($TB.doStringify(e)),"function"==typeof r&&(s.webSocket.onmessage=function(e){e&&e.data&&r(e.data),s.webSocket.onmessage=null}),void 0):(a(e,null,r),void 0)}function n(e,t){var n=$TB.doStringify(e),r=i.getAction+"?data="+encodeURIComponent(n);return u(r,t)}function r(e,t,n){e?console.log(e):n.html(t)}function u(t,n){try{if(window.XDomainRequest!==void 0)try{var r=new XDomainRequest;r.onload=function(){n&&n(null,r.responseText)},r.onerror=function(e){console.log("Exception doing xdr get: "+e)},r.open("get",t,!0),r.ontimeout=function(){},r.onprogress=function(){},r.timeout=6e4,setTimeout(function(){r.send()},100)}catch(o){console.log("Exception doing xdr get"),console.log(o)}else{var i=e();i&&(i.open("get",t,!0),i.onreadystatechange=function(){4===i.readyState&&n&&"function"==typeof n&&n(null,i.responseText)},i.send(null))}}catch(o){console.log("Exception doing xhr get"),console.log(o)}}function l(t,n){var r=i.xPostAction,o=$TB.doStringify(t);if(window.XDomainRequest!==void 0)try{var a=new XDomainRequest;a.open("POST",r),a.timeout=6e4,a.onprogress=function(){},a.ontimeout=function(){},a.onerror=function(){},a.send("data="+encodeURIComponent(o))}catch(c){}else{var u=e();if(u)u.open("POST",r,!0),u.onreadystatechange=function(){4===u.readyState&&n&&n(null,u.responseText)},u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),u.send("data="+encodeURIComponent(o));else{var l=document.createElement("iframe"),d=document.getElementsByTagName("html");if(d[0].appendChild(l),l.doc=null,l.contentDocument?l.doc=l.contentDocument:l.contentWindow?l.doc=l.contentWindow.document:l.document&&(l.doc=l.document),null===l.doc)throw"Document not found, append the parent element to the DOM before creating the IFrame";l.doc.open(),l.doc.close();var f=l.doc.createElement("form");f.setAttribute("method","post"),f.setAttribute("action",i.formPostAction),f.acceptCharset="UTF-8",f.target="_self",s.postForm=f;var p=l.doc.createElement("input");p.name="data",p.value="[empty]",f.appendChild(p),s.postField=p,l.doc.body.appendChild(f),l.setAttribute("width",1),l.setAttribute("height",1),l.setAttribute("style","border: none;"),s.postField.value=o,s.postForm.submit(),l.onload=function(){try{setTimeout(function(){l&&l.parentNode&&"function"==typeof l.parentNode.removeChild&&l.parentNode.removeChild(l)},100)}catch(e){}}}}}function d(e,t){if("function"!=typeof jQuery)return!1;var n=jQuery().jquery.split(".");return e>n[0]?!1:t&&t>n[1]?!1:!0}var f={doc:window.document,translated:!1,get_cookies:function(){if(this.doc.cookie){var e=this.doc.cookie.split(";");o.cookies={};for(var t=e.length-1;t>=0;t--){var n=e[t].split("=");try{n[0]=n[0].replace(/\./g,"_dot_")}catch(r){}o.cookies[n[0]]=n[1]}}},get_qs_parts:function(e){var t={};if(e&&e.length){if(e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#"))),e.indexOf("?")>-1){for(e=e.slice(e.indexOf("?")+1,e.length),e=e.split("?");""===e[0];)e.shift();e=e[0]}if(e!==void 0)for(var n=e.split("&"),r=n.length-1;r>=0;r--){var o=n[r].split("=");2>o.length||(t[o[0]]=decodeURIComponent(o[1]))}}return t},get_queryString:function(){var e={};return location&&location.search&&(e=this.get_qs_parts(location.search)),e},get_documentProperties:function(){var e={};document&&(document.referrer&&(e.r=document.referrer),e.t=document.title),e.u=location.href,o.doc=e},slugifyCats:function(e){var t=[],n=function(e){return e=(e||"")+"",e=e.toLowerCase().replace(/\s+/g,"-").replace(/\&/g,"and").replace(/£/g,"gbp").replace(/[^\w\-]+/g,"-").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")};if(!e||0===e.length)return t;if("string"==typeof e)return[n(e)];for(var r=0;e.length>r;r++){var o=e[r];if("string"==typeof o)t.push(n(o));else{var i="";o.g&&(i=n(o.g)+":"),o.n&&(i+=n(o.n)),i&&t.push(i)}}return t},setEid:function(e,t){!o.e&&e&&t&&(o.eid=t+":"+e,window.$TB&&$TB.sendBeacon())},get_text:function(e,t,n){var r,o="",i=[];if(e){if("string"==typeof e)o=e;else{if("undefined"!=typeof MooTools&&"object"==typeof e&&e.length&&"function"==typeof e.get&&e.jquery===void 0){if(o=e.get("text"),t){for(i=[],r=0;o.length>r;r++)o[r]=this.stripWS(o[r]),""!==o[r]&&i.push(o[r]);o=i}return 1===o.length&&(o=o[0]),o}o="function"==typeof e.text?e.text():e.innerText||e.textContent||e.nodeValue}o===void 0&&"function"==typeof jQuery&&"object"==typeof e&&e.length&&(o=jQuery(e).text())}if(n){if(o=o.split(n),t){for(i=[],r=0;o.length>r;r++)o[r]=this.stripWS(o[r]),""!==o[r]&&i.push(o[r]);o=i}}else if(t)return this.stripWS(o);return o},extend:function(e,t){if("object"!=typeof e||"object"!=typeof t||null===e||null===t)return null;if("function"==typeof window.jQuery&&window.jQuery.extend)return window.jQuery.extend(e,t);if("function"==typeof Object.assign)return Object.assign(e,t);if("function"==typeof Object.merge)return Object.merge(e,t);if("function"==typeof window._){if(window._.assign)return window._.assign(e,t);if(window._.extend)return window._.extend(e,t)}return null},oneof:function(e,t){if(!e||!t||"object"!=typeof t||!t.length)return!1;var n=0;for(n;t.length>n;n++)if(e.toLowerCase().indexOf(t[n].toLowerCase())>-1)return!0;return!1},allof:function(e,t){var n;if(!t||"object"!=typeof t||!$TB.has_own(t,"length"))return!1;if(!e||"string"!=typeof e)return!1;if(0===t.length)return!0;for(n=0;t.length>n;n++){var r=t[n];if("string"!=typeof r)try{r=""+r}catch(o){return!1}if(0>e.toLowerCase().indexOf(r.toLowerCase()))return!1}return!0},identify_ptyp:function(e,t){t=t?t:{},t.args=t.args||[],t.returns=t.returns||function(e){return e};for(var n=0;e.length>n;n++){var r=e[n].apply(void 0,t.args);if(r)return t.returns(r)}},get_value_from_text:function(e){var t,n,r;if(!e)return 0;var o=function(e){try{return Number(e)}catch(t){}},i=function(e,t){return e.replace(RegExp("\\"+t,"g"),"")},a=function(e){return e.replace(",",".")};return"string"!=typeof e?o(e):(e=e.replace(/[^0-9.,]/g,""),e.match(/^[0-9]+((\.|,)[0-9]{0,2})?$/)?o(a(e)):e.match(/^[0-9]+((\.|,)[0-9]{3})+$/g)?o(i(i(e,"."),",")):(r=e.match(/^[0-9]+((\.|,)[0-9]{3})+(\.|,)[0-9]{0,2}$/))?(t=i(e.substring(0,e.lastIndexOf(r[3])),r[2]),n=a(e.substring(e.lastIndexOf(r[3]))),o(t+n)):void 0)},get_round_number:function(e,t){return e=Number(e),Number(e.toFixed(t))},format_currency:function(e,t,n){try{var r=n||{},o=2,i=r;if(i&&i.s||(i=$TB.currs&&$TB.currs[t]?$TB.currs[t]:null),void 0!==r.dec&&(o=r.dec),void 0===r.sep&&(r.sep={}),!i)return e||"";if(!isNaN(e)&&(e=Number(e).toFixed(o),void 0!==r.sep.d?e=e.replace(/\./g,r.sep.d):r.sep.d=".",void 0!==r.sep.t)){var a=e.lastIndexOf(r.sep.d),c=[],s=1;for(a=a>-1?a:e.length,c.unshift(e.substring(a--)),a;a>-1;a--,s++)c.unshift(e[a]),a&&0===s%3&&c.unshift(r.sep.t);e=c.join("")}"a"===i.p?e+=i.s:e=i.s+e}catch(u){}return e},get_url_parts:function(e){var t=document.createElement("a");t.href=e,t.host||(t.href=t.href);var n=t.pathname;n&&0!==n.indexOf("/")&&(n="/"+n);var r=t.host;return r&&r.indexOf(":")>-1&&(r=r.replace(/:\d+/,"")),{href:t.href,protocol:t.protocol+"//",host:r,pathname:n,search:t.search,hash:t.hash}},get_base_url:function(e,t){if(!e&&""!==e)return"";var n=$TB.get_url_parts(e),r=n.protocol+n.host+n.pathname;return t&&(r+=n.search),r},get_full_url:function(e){return $TB.get_url_parts(e).href},is_valid_email:function(e){var t=e.lastIndexOf("@"),n=e.lastIndexOf("."),r=e.indexOf("@"),o=e.indexOf(".");return 1>r||1>o?!1:r!==t?!1:t+1>=n?!1:n+2>=e.length?!1:!0},guid:{generate:function(){return $TB.guid._counter=$TB.guid._counter+1,"GUID"+$TB.guid._counter.toString(16).toUpperCase()},_counter:Math.floor(16394*Math.random())+8192},Event:{_map:{},on:function(e,t,n){var r=$TB.Event._add(e,t,n);return $TB.Event._start(r),r},off:function(e,t){return $TB.Event._stop(e)&&t?$TB._remove(e):!0},toggle:function(e){return $TB.Event._map[e]?$TB.Event._stop(e):$TB.Event._start(e)},_add:function(e,t,n){var r=$TB.guid.generate();return $TB.Event._map[r]=function(r){return{_evth:function(){var e=[].slice.call(arguments);return $TB.Event._map[r]?$TB.Event._map[r].func.apply(this,[r].concat(e)):void 0},element:e,live:!1,guid:r,type:t,func:n,data:{}}}(r),r},_remove:function(e){return delete $TB.Event._map[e],!0},_start:function(e){var t=$TB.Event._map[e];if(t.element.addEventListener)t.element.addEventListener(t.type,t._evth,!1);else{if(!t.element.attachEvent)return!1;t.element.attachEvent("on"+t.type,t._evth)}return t.live=!0,!0},_stop:function(e){var t=$TB.Event._map[e];if(t.element.removeEventListener)t.element.removeEventListener(t.type,t._evth,!1);else{if(!t.element.detachEvent)return!1;t.element.detachEvent("on"+t.type,t._evth)}return t.live=!1,!0},Middleware:{when:function(e){var t,n=this;return t=function(){function t(){}return t.use=function(){var t,r;return r=arguments[0],t=[].slice.call(arguments,1),r.apply(n,[e].concat(t)),this},t.provide=function(t){var n=$TB.Event._map[e];for(var r in t)$TB.has_own(t,r)&&(n.data[r]=t[r]);return this},t}()},times:function(e,t,n){var r=$TB.Event._map[e].func,o=0;return $TB.Event._map[e].func=function(){t>o++?r.apply(this,arguments):$TB.Event.off(e,n)},e},nth:function(e,t){var n=$TB.Event._map[e].func,r=0;return $TB.Event._map[e].func=function(){1>r++%t&&n.apply(this,arguments)},e},filter:function(e,t){var n=$TB.Event._map[e],r=n.func;return $TB.Event._map[e].func=function(){if(t.apply(this,arguments))r.apply(this,arguments);else{var n=$TB.Event._map[e].data.defer_id;n&&$TB.Scheduler._map[n]&&$TB.Scheduler.cancel(n)}},e},email:function(e){return $TB.Event.Middleware.filter(e,function(){var t=$TB.Event._map[e],n=t.data.options.value();return $TB.is_valid_email(n)})},defer:function(e,t){var n=$TB.Event._map[e].func;return $TB.Event._map[e].func=function(){var r=$TB.Event._map[e].data.defer_id,o=$TB.Scheduler._map[r],i=this,a=arguments;r&&o&&$TB.Scheduler.cancel(r),$TB.Event._map[e].data.defer_id=$TB.Scheduler.delay(function(){n.apply(i,a)},{wait:t})},e},throttle:function(e,t,n){var r=$TB.Event._map[e].func;return n!==!1&&(n=!0),$TB.Event._map[e].func=function(){var o=$TB.Event._map[e],i=o.data.throttle_last,a=1*new Date,c=this,s=arguments;if(o.data.throttle_id&&($TB.Scheduler.cancel(o.data.throttle_id),delete o.data.throttle_id),!i||a>i+t)o.data.throttle_last=a,r.apply(this,arguments);else if(n){var u=t-(a-i);o.data.throttle_id=$TB.Scheduler.delay(function(){o.data.throttle_last=1*new Date,r.apply(c,s)},{wait:u})}},e}}},Scheduler:{_map:{},delay:function(e,t){var n=$TB.guid.generate(),r=1*new Date,o=window.setTimeout(function(){delete $TB.Scheduler._map[n],e.apply(this,arguments)},t.wait);return $TB.Scheduler._map[n]={guid:n,func:e,id:o,at:r+t.wait},n},waitfor:function(e,t,n){var r=$TB.guid.generate(),o=1*new Date,i=window.setInterval(function(){if($TB.Scheduler._map[r]){if($TB.Scheduler._map[r].counter++,$TB.Scheduler._map[r].limit&&$TB.Scheduler._map[r].counter>$TB.Scheduler._map[r].limit)return $TB.Scheduler.cancel(r),void 0;e()&&($TB.Scheduler.cancel(r),t.apply(this,arguments))}},n.interval);return $TB.Scheduler._map[r]={guid:r,func:t,id:i,interval:n.interval,started:o,counter:0,limit:n.limit},r},empty:function(){var e;for(e in $TB.Scheduler._map)$TB.has_own($TB.Scheduler._map,e)&&(window.clearTimeout(e.id),delete $TB.Scheduler._map[e.guid]);return!0},cancel:function(e){return $TB.Scheduler._map[e]?(window.clearTimeout($TB.Scheduler._map[e].id),delete $TB.Scheduler._map[e],!0):!1}},fieldListener:function(e,t,n){if(n=n?n:{},!t)return $TB.fieldListener(e,[],n);if(void 0!==t.length||t.jquery){for(var r=function(e){var t=function(t){return function(){var n;for(n=0;e.length>n;n++)e[n][t].apply(void 0,arguments);return this}};return function(){function e(){}return e.use=t("use"),e.provide=t("provide"),e}()},i=[],a=0;(t.length||0)>a;a++)i.push($TB.fieldListener(e,t[a],n));return r(i)}n.max_actions=n.max_actions||32,n.immediate=n.immediate?!0:!1,n.email_field=n.email_field?!0:!1,n.base_object=n.base_object||o,n.defer!==!1&&(n.defer=n.email_field&&"keyup"===n.event?n.defer||1024:n.defer||512),n.action=n.action||function(){$TB.sendBeacon()},n.ignore=n.ignore||[],"string"==typeof n.ignore&&(n.ignore=[n.ignore]),n.value=n.value||function(){return t.value},n.event=n.event||"change";var c,s=e.split("."),u=n.base_object;for(c=0;s.length-1>c;c++)u[s[c]]||(u[s[c]]={}),u=u[s[c]];var l=function(e){var t=n.value(e);if("string"==typeof t&&(t=$TB.stripWS(t)),void 0!==t&&""!==t){if("string"==typeof t){var r=0,o=t.toLowerCase();for(r;n.ignore.length>r;r++)if(n.ignore[r].toLowerCase()===o)return{act:!1,value:t}}return u[s[s.length-1]]=t,{act:!0,value:t}}return{act:!1,value:void 0}};if(n.immediate&&(n.email_field?$TB.is_valid_email(n.value())&&l({target:t,type:"immediate"}):l({target:t,type:"immediate"})),"change"===n.event||"keyup"===n.event){var d=document.createElement("input"),f="oninput";f in d&&(d.setAttribute(f,"return;"),"function"==typeof d.oninput&&(n.event="input")),d=null}var p=$TB.Event.on(t,n.event,function(e,t){var r;(r=l(t)).act&&n.action(r.value)}),g=$TB.Event.Middleware.when(p).provide({options:n}).use($TB.Event.Middleware.times,n.max_actions);return n.defer&&(g=g.use($TB.Event.Middleware.defer,n.defer)),n.email_field&&(g=g.use($TB.Event.Middleware.email)),g},getCookie:function(e){return this.Cookies(e)},getRtDom:function(e){e=e||[];var t=document.createElement("a");t.href=document.location.href;for(var n=t.hostname,r=0;e.length>r;r++){var o=e[r];if(!n.indexOf(o))return n.replace(o+".",".")}return n},setCookie:function(e,t,n){i.rootCookie&&!i.ckDom&&(i.ckDom=this.getRtDom(i.rootCookie));var r={path:"/",expires:n};i.ckDom&&(r.domain=i.ckDom),this.Cookies.set(e,t,r)},setVisitorID:function(e,t){var n,r=this.getCookie("tms_VisitorID"),i=r&&0===r.search(/^[a-z0-9]*$/);return i&&!e?n=r:(r&&(o.oldc=r),n=Math.floor(36*Math.random()).toString(36)+parseInt(1e10*Math.random(),10).toString(36).substring(2,6)+(1*new Date).toString(36).substr(3)),$TB.setCookie("tms_VisitorID",n,t),n},needWSIP:function(){return!this.getCookie("tms_wsip")},setWSIP:function(){this.setCookie("tms_wsip",1,new Date((new Date).getTime()+18e5))},setDetails:function(e,t,n,r,i){i=i||{};var a=i.emailType||"e";if(e&&a)switch(a){case"e":case"b64e":case"rc4e":o[a]=e}t&&(o.fn=t),n&&(o.ln=n),r&&(o.n=r),(e||t||n||r)&&this.sendBeacon("setDetails")},setData:function(e,t){var n=!1;if(e){var r=["e","fn","ln","sbr","curr","lang","b64e","eid","perm"];for(var i in e)e.hasOwnProperty(i)&&-1!==r.indexOf(i)&&(o=o||{},o[i]=e[i],n=!0)}if(t)for(var a in t)t.hasOwnProperty(a)&&(o=o||{},o.extend=o.extend||{},o.extend[a]=t[a],n=!0);n&&this.sendBeacon("setData")},setEmail:function(e){o.e=e},analyzeCartPage:function(){try{o.lang=document.getElementsByTagName("html")[0].lang;var e=$TB.getCookie("SunwingGateway");if(e){o.extend=o.extend||{},o.extend.gateway_code=e;try{var t=jQuery('option[value="'+e+'"]');t.length&&(o.extend.gateway_name=$TB.get_text(t.first(),!0))}catch(n){}}var r=function(e){try{var t=e.split("HotelImages/"),n=t[1].split("/");if(n&&n.length)return n[0].toUpperCase()}catch(r){}return null},i=function(e){for(var t="",n=e.html().split("<br>"),r=0;n.length>r;r++)n[r]&&-1!==n[r].indexOf("•")&&(t+=n[r].replace(/\n/g," "));return t},s=function(e){try{var t="",n=e.replace(RegExp(String.fromCharCode(160),"g")," ").split(/\s+/);t+=n[0].replace("Lun","Mon").replace("Mar","Tue").replace("Mer","Wed").replace("Jeu","Thu").replace("Ven","Fri").replace("Sam","Sat").replace("Dim","Sun"),t+=" "+n[1].replace("Fév","Feb").replace("Avr","Apr").replace("Mai","May").replace("Jui","Jul").replace("Aoû","Aug"),t+=" "+n[2].replace("Fév","Feb").replace("Avr","Apr").replace("Mai","May").replace("Jui","Jul").replace("Aoû","Aug"),t+=" "+n[3];var r=new Date(t),o=r.getDate();10>o&&(o="0"+o);var i=r.getMonth()+1;return 10>i&&(i="0"+i),r.getFullYear()+""+(i+"")+(o+"")}catch(a){return""}};o.typ=c.PAGE_VIEW,o.ptyp=a.OTHER,$TB.currs={AED:{p:"a",s:"د.إ"},ARS:{s:"$"},AUD:{s:"$"},BGN:{s:"лв"},BRL:{s:"R$"},CAD:{s:"$"},CHF:{p:"a",s:"CHF"},CLP:{s:"$"},CNY:{s:"¥"},COP:{s:"$"},CRC:{s:"₡"},CZK:{p:"a",s:"Kč"},DKK:{p:"a",s:"kr"},EUR:{s:"€"},GBP:{s:"£"},GTQ:{s:"Q"},HKD:{s:"HK$"},HUF:{s:"Ft"},IDR:{s:"Rp"},INR:{s:"₹"},ISK:{p:"a",s:"kr"},JPY:{s:"¥"},KRW:{s:"₩"},MKD:{p:"a",s:"ден"},MXN:{s:"$"},MYR:{s:"MYR"},NOK:{p:"a",s:"kr"},NZD:{s:"$"},PLN:{s:"zł"},RON:{s:"lei"},RSD:{s:"РСД"},RUB:{s:"руб "},SAR:{p:"a",s:"﷼"},SEK:{p:"a",s:"kr"},SGD:{s:"$"},THB:{s:"฿"},TRY:{s:"₺"},TWD:{s:"NT$"},USD:{s:"$"},ZAR:{s:"R"}},o.curr="CAD";var u=function(){try{if($TB.oneof(o.doc.u,["book.sunwing.ca/cgi-bin/"])&&jQuery(".sidebar #pricetable").length)return o.ptyp=a.CART,jQuery("body")}catch(e){}},l=function(){try{if($TB.oneof(o.doc.u,["/externallogin","/dologin"]))return o.ptyp=a.LOGIN,jQuery("body")}catch(e){}},d=function(){try{if($TB.oneof(o.doc.u,["payment.sunwing.ca/cgi-bin/rds/booking.cgi"]))return o.ptyp=a.CHECKOUT_THANKS,!0}catch(e){}},f=function(){},p=function(){try{if($TB.oneof(o.doc.u,["payment.sunwing.ca/cgi-bin/rds/booking-form.cgi"])&&jQuery(".sidebar #pricetable").length)return o.ptyp=a.CHECKOUT,jQuery("body")}catch(e){}},g=d()||u()||p()||l()||f(),m={pb:function(e){var t={};try{var n=jQuery('meta[property="og:url"]'),a=jQuery('link[rel="canonical"]');t.u=n.length?n.attr("content"):a.length?(a[0]||{}).href:o.doc.u,t.n=$TB.get_text(e.find("h1 .hotelname").first(),!0),t.desc=i(e.find(".description>p"))}catch(c){}try{t.img=(e.find(".slideshow img")[0]||{}).src,t.prid=$TB.oneof(t.img,["/photo-no-lg-image-en.jpg"])?t.n.replace(/\W+/g,"-").toLowerCase():r(t.img),t.sku=t.prid}catch(c){}try{var s=$TB.get_text(jQuery(".option-header .maplink"),!0,",");s.length>1&&(t.ex=t.ex||{},t.cat=t.cat||[],t.ex.region=s[0],t.cat.push({g:"region",n:t.ex.region,r:!0}),t.ex.country=s[1],t.cat.push({g:"country",n:t.ex.country,r:!0}))}catch(c){}try{e.find("#branding>div.brand-item").each(function(){var e=jQuery(this).find(".brand-image>img");-1!==e.attr("src").indexOf("/Collections/")&&(t.ex=t.ex||{},t.ex.collections=t.ex.collections||[],t.ex.collections.push({img:e.attr("src"),n:e.attr("alt")}),t.cat=t.cat||[],t.cat.push({g:"Collection",n:e.attr("alt")}))}),e.find("div.amenities .icon-text-wrapper").each(function(){var e=jQuery(this),n=$TB.get_text(e.find(".amenity"),!0).replace("(s)","s").toLowerCase(),r=$TB.get_value_from_text($TB.get_text(e.find(".total"),!0));if(t.ex=t.ex||{},t.ex[n]=r,"rooms"===n){var o;o=r>500?"large":r>250?"medium":"small",t.cat=t.cat||[],t.cat.push({g:"Hotel Size",n:o,r:!0})}})}catch(c){}try{t.ex=t.ex||{},t.ex.star_rating=jQuery(".option-header .star-rating .fa-star").length,t.ex.star_rating+=jQuery(".option-header .star-rating .fa-star-half-o").length/2;var u=$TB.get_text(e.find(".option-header .review"),!0,"/")[0];t.rating=$TB.get_value_from_text(u);var l=u.replace(" "+(""+t.rating),"");t.ex.rating_desc=l,t.cat=t.cat||[],t.cat.push({g:"review",n:l,r:!0}),t.ex.review_text=$TB.get_text(jQuery(".option-header .rating-tooltip-wrapper .number"),!0),t.reviews=$TB.get_value_from_text(t.ex.review_text)}catch(c){}try{t.lang=o.lang,t.curr=o.curr,t.uv=1,t.up=$TB.format_currency(t.uv,t.curr)}catch(c){}return t},ca:function(e){var t,n={},c=function(e){return e.substr(e.indexOf("(")+1,e.indexOf(")")-e.indexOf("(")-1)},u=function(){if(n&&n.id||3>t){o.cart={p:[],qty:1,curr:o.curr,lang:o.lang};var u={};try{3>t&&(u.n=$TB.get_text(e.find(".sidebar .hotelname").first(),!0),u.img=(e.find(".slideshow img")[0]||{}).src,u.opt=u.opt||{},u.opt.img=u.img,u.desc=i(e.find(".description p")))}catch(l){}try{!u.img||$TB.oneof(u.img,["photo-no-thumb-image","photo-no-image"])?u.prid=(n.id||"").toUpperCase()||u.n.replace(/\W+/g,"-").toLowerCase():(u.prid=r(u.img)||(n.id||"").toUpperCase(),u.sku=u.prid)}catch(l){}try{var d=$TB.get_text(jQuery(".maplink>a"),!0,",");d.length>1&&(u.ex=u.ex||{},u.opt=u.opt||{},u.cat=u.cat||[],u.ex.region=d[0],u.opt.region=u.ex.region,u.ex.country=d[1],u.opt.country=u.ex.country),3>t&&(u.ex=u.ex||{},u.opt=u.opt||{},u.ex.star_rating=jQuery(".option-header .SVHotelStars .fa-star").length,u.ex.star_rating+=jQuery(".option-header .SVHotelStars .fa-star-half").length/2,u.opt.star_rating=u.ex.star_rating)}catch(l){}try{u.lang=o.lang,u.curr=o.curr,u.qty=1,u.uv=1,u.up=$TB.format_currency(u.uv,u.curr),u.opt=u.opt||{},u.opt.uv=$TB.get_value_from_text(n.price)||$TB.get_value_from_text($TB.get_text(jQuery("#pricetable #total, #pricetable #leGrandTotal"),!0)),u.opt.up=$TB.format_currency(u.opt.uv,u.curr)}catch(l){}try{u.opt=u.opt||{},u.opt.duration=$TB.get_value_from_text($TB.get_text(e.find(".sidebar .inner .hotelnights #nbnights"),!0)),u.opt.duration?u.opt.no_of_rooms=$TB.get_value_from_text($TB.get_text(e.find(".sidebar .inner .hotelnights"),!0,",")[0]):(u.opt.duration=$TB.get_value_from_text($TB.get_text(e.find(".sidebar .inner .hotelnights"),!0,",")[0]),u.opt.no_of_rooms=1),u.opt.room=$TB.get_text(e.find(".sidebar .inner").find("#room, .hotelroomtype").first(),!0);var f=$TB.get_text(jQuery("button.btn_selected").parent().find("li:first"),!0,"|")[0];f||(f=n.variant),f&&(u.opt.variant=f),u.opt.departure_airport=$TB.get_text(e.find(".departingflight .from"),!0),u.opt.dep_airport_code=c(u.opt.departure_airport),u.opt.return_airport=$TB.get_text(e.find(".returnflight .from"),!0),u.opt.ret_airport_code=c(u.opt.return_airport),u.opt.departure_date=($TB.get_text(e.find("#date-dep-for-ajax0"),!0)+" "+$TB.get_text(e.find("#time-dep-for-ajax0"),!0)).replace("&nbsp;",""),u.opt.return_date=$TB.get_text(e.find("#date-dep-for-ajax1"),!0)+" "+$TB.get_text(e.find("#time-dep-for-ajax1"),!0),u.opt.formatted_date=s(u.opt.departure_date)}catch(l){}try{u.opt=u.opt||{},u.opt.no_of_adults=$TB.get_value_from_text($TB.get_text(e.find("#pricetable td:first")[0].childNodes[0],!0)),u.opt.price_per_adult=$TB.get_value_from_text($TB.get_text(e.find("#adultPrice, #adultprice"),!0)),e.find("tr").has('td:contains("Child"), td:contains("child"), td:contains("Enfant"), td:contains("enfant")').each(function(){var e=jQuery(this),t=$TB.get_text(e.find("td").first()),n=$TB.get_value_from_text(t.substr(t.indexOf("(")+1,t.indexOf(")")-t.indexOf("(")-1));u.opt.children=u.opt.children||[],u.opt.children.push({text:t,price:$TB.get_value_from_text($TB.get_text(e.find("td").last(),!0)),age:n})}),e.find(".option-header ul.deals li.savings").length&&(u.opt.save_text=$TB.get_text(e.find(".option-header ul.deals li.savings").first(),!0))}catch(l){}try{e.find("#options #options_table tr:has(td)").each(function(){var e=jQuery(this);u.opt=u.opt||{},u.opt.upgrades=u.opt.upgrades||[],u.opt.upgrades.push({name:$TB.get_text(e.find("td").first(),!0),value:$TB.get_value_from_text($TB.get_text(e.find("td:last")[0].childNodes[0],!0))})})}catch(l){}try{var p=jQuery('input[name="nohotel"]').val();p&&(u.ex=u.ex||{},u.ex.hotel_no=p,u.opt.hotel_no=u.ex.hotel_no);var g=jQuery('script[src*="https://www.sunwing.ca/disclaimer_bookingpath"]').attr("src");if(g){var m=$TB.get_qs_parts(g).dest;m&&(o.extend=o.extend||{},o.extend.last_dest_dep=m,u.opt=u.opt||{},u.opt.dest_dep=m)}}catch(l){}o.cart.p.push(u);var h=o.cart.cv;o.cart.cv=$TB.get_value_from_text($TB.get_text(jQuery("#pricetable #total, #pricetable #leGrandTotal"),!0)),o.cart.cp=$TB.format_currency(o.cart.cv,o.curr),o.cart.ex=o.cart.ex||{},o.cart.ex.taxes=$TB.get_value_from_text($TB.get_text(jQuery("#pricetable .pricetaxesfees").first(),!0)),o.cart.cv!==h&&$TB.sendBeacon()}else o.ptyp=a.OTHER,$TB.sendBeacon()};o.skip_initial_beacon=!0,$TB.Scheduler.waitfor(function(){try{for(var r=0;window.dataLayer.length>r;r++)if(window.dataLayer[r].hasOwnProperty("ecommerce")){if(e.find(".slideshow img").length&&e.find(".sidebar .hotelname").length)return n=window.dataLayer[r].ecommerce.detail.products[0],t=2,!0;if(3===e.find("#content ol.progress>.progress-done").length)return n=window.dataLayer[r].ecommerce.add.products[0].id?window.dataLayer[r].ecommerce.add.products[0]:{},t=3,!0}if(e.find(".slideshow img").length&&e.find(".sidebar .hotelname").length)return n={},t=2,!0;if(3===e.find("#content ol.progress>.progress-done").length)return n={},t=3,!0}catch(o){}},u,{interval:250,limit:20}),jQuery("button[data-room]").click(function(){window.setTimeout(u,100)}),jQuery(".option-body  button.one_other_option").click(function(){window.setTimeout(u,3500)}),$TB.Scheduler.waitfor(function(){return jQuery("#emailquote>a").length},function(){jQuery("#emailquote>a").click(function(){$TB.Scheduler.waitfor(function(){return jQuery("#email-quote-form #btn_email_quote").length},function(){$TB.fieldListener("e",jQuery("#email-quote-form #email"),{email_field:!0,immediate:!0}),$TB.fieldListener("fn",jQuery("#email-quote-form #firstname")),$TB.fieldListener("ln",jQuery("#email-quote-form #lastname")),jQuery("#btn_email_quote").click(function(){$TB.Scheduler.waitfor(function(){return"block"===jQuery(".email-quote-content--success").css("display")},function(){$TB.raiseSignal("quote_emailed",{},{includeCart:!0})},{interval:250,limit:30})})},{interval:250,limit:40})})},{interval:250,limit:40})},lo:function(e){try{$TB.fieldListener("e",e.find("input#login"),{email_field:!0,immediate:!0})}catch(t){}},re:function(e){try{$TB.fieldListener("e",e.find("#email"),{email_field:!0,immediate:!0}),$TB.fieldListener("fn",e.find("#firstname")),$TB.fieldListener("ln",e.find("#lastname"))}catch(t){}},co:function(e){try{$TB.fieldListener("e",e.find("#EMAIL"),{email_field:!0,immediate:!0}),$TB.fieldListener("fn",e.find("#FIRST_NAME1")),$TB.fieldListener("ln",e.find("#LAST_NAME1"))}catch(t){}},pc:function(){o.skip_initial_beacon=!0,$TB.Scheduler.waitfor(function(){return jQuery("#contenu>#content .confirmnumber p").length&&!jQuery('#loading:visible #content>img[src*="sunwing-loader.gif"]').length?!0:void 0},function(){var e=$TB.get_text(jQuery('.billingsummary .item:contains("Email address"), .billingsummary .item:contains("Adresse courriel")').find("p"),!0);$TB.is_valid_email(e)&&(o.e=e);var t=$TB.get_text(jQuery("#contenu>#content h1").first(),!0);if($TB.oneof(t,["Package Booking Confirmation","Confirmation de la réservation du forfait"])){o.co={};try{o.co={};var n=jQuery(".confirmnumber p").first();n.length&&(o.co.o_num=$TB.get_text(n,!0))}catch(r){}$TB.sendBeacon()}else o.ptyp=a.OTHER,$TB.sendBeacon()},{interval:250,limit:40})}};switch(o.ptyp){case a.CART:m.ca(g);break;case a.LOGIN:m.lo(g);break;case a.CHECKOUT:m.co(g);break;case a.CHECKOUT_THANKS:m.pc(g)}$TB.oneof(o.doc.u,["vip.sunwing.ca/forgotPassword"])&&$TB.fieldListener("e",jQuery("#forgot-email"),{email_field:!0,immediate:!0}),$TB.Scheduler.waitfor(function(){try{return jQuery("#formNewsLetter").length}catch(e){}},function(){$TB.fieldListener("e",jQuery("input#signUpEmail"),{email_field:!0,immediate:!0})},{interval:250,limit:20}),$TB.oneof($TB.get_base_url(o.doc.u),["sunwing.ca/en/grouptravel/","sunwing.ca/Pages/en/group-quote"])&&$TB.raiseSignal("group_travel",{url:$TB.get_base_url(o.doc.u)});try{"hotelpage"===document.getElementsByTagName("html")[0].dataset.template&&(o.skip_initial_beacon=!0,delete o.ptyp,$TB.Scheduler.waitfor(function(){try{if(jQuery)return jQuery(".slideshow img").length}catch(e){}},function(){var e=m.pb(jQuery("body"));o.p=[],o.p.push(e),o.ptyp=a.PRODUCT_BROWSE,$TB.sendBeacon()},{interval:300,limit:20}))}catch(n){}}catch(n){}},analyzeInPageCart:function(e){"function"!=typeof this.onAnalyzeInPageCart||this.translated||(o=this.onAnalyzeInPageCart(o,e),o.p&&delete o.p,this.sendBeacon("analyzeInPageCart"))},attr:window.Element&&Element.prototype&&Element.prototype.getAttribute?function(e,t){return{value:e.getAttribute(t)}}:function(e,t){return e.getAttributeNode(t)},addKlarnaListener:function(){try{window._klarnaCheckout&&window._klarnaCheckout(function(e){e.on({change:function(e){var t=!1;e.email&&""!==e.email&&o.e!==e.email&&(o.e=e.email,t=!0),e.given_name&&""!==e.given_name&&o.fn!==e.given_name&&(o.fn=e.given_name,t=!0),e.family_name&&""!==e.family_name&&o.ln!==e.family_name&&(o.ln=e.family_name,t=!0),t&&$TB.sendBeacon()}})})}catch(e){}},addSveaListener:function(){try{var e=function(){try{window.scoApi.observeModel("identity.email",function(e){e.value&&e.value!==o.e&&(o.e=e.value,$TB.sendBeacon())})}catch(e){}try{window.scoApi.observeModel("identity.firstName",function(e){e.value&&e.value!==o.fn&&(o.fn=e.value,$TB.sendBeacon())})}catch(e){}try{window.scoApi.observeModel("identity.lastName",function(e){e.value&&e.value!==o.ln&&(o.ln=e.value,$TB.sendBeacon())})}catch(e){}};window.scoApi?e():document.addEventListener("checkoutReady",function(){window.scoApi&&e()})}catch(t){}},handleSlotConfig:function(e,t){var n=[],r=null,i={},a=function(e,r,o){var c=jQuery("<div/>").addClass("tmspslot").attr("data-k",t.k).attr("data-from-config","1").attr("data-slid",r).attr("data-ruleid",o.ruleid);if(!o.multi&&e.length>1&&(e=jQuery(e[0])),(o.personalised||o.dynamic)&&c.attr("data-p","1"),o.css&&c.css(o.css),"after"===o.position?c.insertAfter(e):"before"===o.position?c.insertBefore(e):"prepend"===o.position?c.prependTo(e):"replace"===o.position?(c.insertBefore(e),e.attr("data-tms-hide-on-slot-load",r)):"replaceContents"===o.position?(e.children().attr("data-tms-hide-on-slot-load",r),c.appendTo(e)):"replaceAlways"===o.position?e.replaceWith(c):"replaceContentsAlways"===o.position?e.html(c):c.appendTo(e),n.push(c),i[r]){for(var s=0;i[r].length>s;s++){var u=i[r][s];a(c,u.slotid,u.rule)}i[r]=void 0}return c};for(var c in t.rules)for(var s=0;t.rules[c].length>s;s++)try{var u=t.rules[c][s],l=!0;if(u.disabled||!u.pageSpec)continue;var d=!1;if(u.pageSpec.type)for(var f=0;u.pageSpec.type.length>f&&!d;f++)if(o.ptyp===u.pageSpec.type[f]||"all"===u.pageSpec.type[f]){d=!0;break}if(u.pageSpec.location){r||(r=document.createElement("a"),r.href=o.doc.u);for(var f=0;u.pageSpec.location.length>f;f++){var p=u.pageSpec.location[f],g=!0;for(var m in p){var h=r[m];if("pathname"===m&&(""===h||h&&"/"!==h[0])&&(h="/"+h),p[m]!==h){g=!1;break}}if(g){d=!0;break}}}if(!d){l=!1;continue}if(u.pageSpec.hasElements&&u.pageSpec.hasElements.length)for(var f=0;u.pageSpec.hasElements.length>f&&l;f++)jQuery(u.pageSpec.hasElements[f].selector).length||(l=!1);if(l&&"function"==typeof u.pageSpec.func&&(u.pageSpec.func()||(l=!1)),l){var v=null;u.target.selector?v=jQuery(u.target.selector):u.target.rule&&(v=jQuery('[data-ruleid="'+u.target.rule+'"]'),v.length||(i[u.target.rule]||(i[u.target.rule]=[]),i[u.target.rule].append({slotid:c,rule:u}))),v&&v.length&&a(v,c,u)}}catch(y){}return n.length&&this.loadPageSlots(),n},loadPageSlots:function(){var e=$TB.getCookie("tms_slotpreview"),t={};if(e){e=e.split(",");for(var n=0;e.length>n;n++){var i=e[n].split("||")[1],a=e[n].split("||")[0];t[i]=a}}"function"==typeof jQuery&&jQuery(".tmspslot").each(function(n,i){try{i=jQuery(i);var a=i.attr("data-slid"),c=i.attr("data-k"),s=i.attr("data-state"),l="//d1y9qtn9cuc3xw.cloudfront.net/"+o.w;l+=$TB.getCookie("tms_ft")&&e&&t[a]?"/sb/"+t[a]:"/s/"+a,l+="/?k="+c,$TB.getCookie("tms_ft")&&(l+="&tracebar=1"),a&&!s&&(l=$TB.addMergesToUrl(l,i),i.attr("data-state","loading"),u(l,function(e,t){if(r(e,t,i),i.attr("data-state","loaded"),!e&&t&&jQuery('[data-tms-hide-on-slot-load="'+a+'"]').hide(),"function"==typeof window.frOnSlotLoad){var n=Boolean(jQuery(t).length),o={html:jQuery(t).not("style")};
window.frOnSlotLoad(n,a,o)}}))}catch(d){}})},addMergesToUrl:function(e,t){var n,r,i;if("function"==typeof $TB.getSlotCategories)try{n=$TB.slugifyCats($TB.getSlotCategories(o))}catch(t){}else if(o.ptyp==a.PRODUCT_BROWSE&&o.p&&o.p.length&&(n=$TB.slugifyCats(o.p[0].cat||[]),o.p[0].subcat&&o.p[0].subcat.length))for(var c=$TB.slugifyCats(o.p[0].subcat),s=0;c.length>s;s++)n.push(c[s]);if("function"==typeof $TB.getExtraSlotQSOptions)try{i=$TB.getExtraSlotQSOptions(o)}catch(t){}o.ptyp==a.PRODUCT_BROWSE&&o.p&&o.p.length&&(r=o.p[0].prid);var u=t.dataset||{};try{n&&n.length&&(e+="&cats="+encodeURIComponent(n.join("||")))}catch(t){}try{if(i&&"object"==typeof i)for(var l in i)$TB.has_own(i,l)&&(e+="&"+l+"="+encodeURIComponent(i[l]))}catch(t){}if(t.attr("data-p")){e+="&d="+o.c,r&&(e+="&prid="+encodeURIComponent(r));var u={};if(d(1,4))u=t.data();else for(var f=t[0].attributes,p=0;f.length>p;p++){var g=f[p].name;if(0===g.indexOf("data-")){var m=f[p].value,h=g.split("-");h.splice(0,1);for(var v=1;h.length>v;v++)h[v]=h[v][0].toUpperCase()+h[v].substring(1);u[h.join("")]=m}}var y;e+="&url="+encodeURIComponent(o.doc.u);for(var _ in u)if(0==_.indexOf("merge")){var T=u[_];_=_.replace("merge","").toLowerCase(),e+="&"+_+"="+encodeURIComponent(T)}else 0===_.indexOf("qs")&&(y||(y=$TB.get_queryString()),_=_.replace("qs","").toLowerCase(),y[_]!==void 0&&(e+="&"+_+"="+encodeURIComponent(y[_])))}return void 0!==o.sbr&&(e+="&sbr="+encodeURIComponent(o.sbr)),o.curr&&(e+="&curr="+encodeURIComponent(o.curr)),o.lang&&(e+="&lang="+encodeURIComponent(o.lang)),e},analyzePage:function(){var e=new Date((new Date).getTime()+48384e6),t=!1;if(t){var n=$TB.getCookie("tms_SessionID");if(n)o.s=n,$TB.setCookie("tms_SessionID",o.s,e);else{window.addEventListener("message",function(t){-1===t.origin.indexOf("//am.freshrelevance.com")||$TB.getCookie("tms_SessionID")||"string"==typeof t.data&&(o.s=t.data,$TB.setCookie("tms_SessionID",o.s,e),$TB.sendBeacon("runInitial"))},!1),o.skip_initial_beacon=!0;var c;c=document.createElement("iframe"),c.style.cssText="display: none !important;",c.src="//am.freshrelevance.com/tpc/",document.body.appendChild(c)}}o.c=this.setVisitorID(!1,e),o.w=$FR_LAB._wid,"function"==typeof window.__$TB_vid?window.__$TB_vid(o.c):"function"==typeof jQuery&&jQuery(".tmspwfeed").each(function(e,t){try{t=jQuery(t);var n=t.attr("data-feed");n&&("http:"===location.protocol&&(n=n.replace("https:","http:")),(-1!==n.indexOf("/personalised/")||-1!==n.indexOf("/cart/")||-1!==n.indexOf("/person/full/"))&&(n=n+"&d="+o.c),u(n,function(e,n){r(e,n,t)}))}catch(i){}}),$FR_LAB.d&&$FR_LAB.d.ip&&(o.ip=$FR_LAB.d.ip),o.v=$FR_LAB.v||null,this.get_documentProperties();try{o.tmsd={},o.extend={};var s=document.getElementById("__tmsd");if(s)for(var l,d=["e","cid","s","nomail","perm"],f=d.length;f--;)l=this.attr(s,d[f]),l&&(o.tmsd[d[f]]=l.value);var p=o.tmsd.nomail;"nomail"===o.c||!p||"1"!==p&&"checked"!==p&&"true"!==p||(o.ptyp=a.DNT_PREFERENCE,e=new Date((new Date).getTime()+48384e6),this.setCookie("tms_VisitorID","nomail",e),o.c="nomail")}catch(g){}if("function"==typeof this.analyzeCartPage){try{"function"==typeof window.onFRLoaded&&window.onFRLoaded()}catch(m){}this.analyzeCartPage()}if("function"==typeof $TB.insertSmartBlock)try{$TB.insertSmartBlock()}catch(g){}if($FR_LAB.slot_config){var h=this;$FR_LAB.script($FR_LAB.slot_config).wait(function(){void 0!==o.ptyp?h.handleSlotConfig(null,$TM_CC()):$TB.Scheduler.waitfor(function(){return void 0!==o.ptyp},function(){h.handleSlotConfig(null,$TM_CC())},{interval:50,limit:400})})}var v=$TB.get_queryString().frccpreview||$TB.getCookie("frccpreview");v&&($TB.setCookie("frccpreview",v,new Date((new Date).getTime()+18e5)),setTimeout(function(){var e=i.host+"/config_preview.js?w="+$FR_LAB._wid+"&k="+v;$FR_LAB.script(e)},100));var y=$TB.getCookie("tms_slotpreview")||"",_=$TB.get_queryString().slotpreview||"";if(_){var T="||"+_.substr(_.indexOf("||")+2);if(-1===y.indexOf(T))y.length&&(y+=","),y+=_;else{for(var B=y.split(","),w=0;B.length>w;w++)-1!==B[w].indexOf(T)&&(B[w]=_);y=B.join(",")}}if(y&&$TB.setCookie("tms_slotpreview",y),this.loadPageSlots(),"function"==typeof this.addKlarnaListener)try{this.addKlarnaListener()}catch(g){}if("function"==typeof this.addSveaListener)try{this.addSveaListener()}catch(g){}if(o.ptyp===a.LOGIN_THANKS&&this.get_cookies(),o.ptyp===a.CHECKOUT_THANKS)try{var $=document.getElementById("__tms_pc");if($){var S=this.attr($,"src");if(S){var b=this.get_qs_parts(S.value);b&&(b.e&&!o.e&&(o.e=b.e),b.r&&(o.co||(o.co={}),o.co.o_num||(o.co.o_num=b.r)))}}}catch(g){}var x=window.nrlskOnEvent||null;return window.nrlskOnEvent=function(e){try{x&&x(e)}catch(t){}e&&"subscribe"===e.type&&!o.e&&$TB.setDetails(decodeURIComponent(e.email))},o.ua=navigator.userAgent,o},postBack:function(e,r){if("function"!=typeof r&&(r=null),i.webSockets)try{return t(e,r),void 0}catch(o){i.webSockets=!1,console.log(o)}"heartbeat"===e.type?n(e,r):l(e,r)},raiseSignal:function(e,t,n){if(n=n||{},e){var r={w:o.w,c:o.c,ua:o.ua,v:o.v,typ:c.CUSTOM_SIGNAL,ptyp:o.ptyp||0,ns:e,extra:t,doc:o.doc};n.includeCart&&(o.cart?r.cart=o.cart:o.p&&(r.p=o.p)),o.ip&&(r.ip=o.ip),this.onSendBeacon&&"function"==typeof this.onSendBeacon&&this.onSendBeacon(r),this.postBack({type:"beacon",data:r},this.onBeaconResponse||null)}},sendSync:function(e,t,n,r){var i={w:o.w,c:o.c,ua:o.ua,v:o.v,doc:o.doc};i=$TB.extend(i,n),null!==i&&(i.typ=t||c.PAGE_VIEW,i.ptyp=e||0,o.ip&&(i.ip=o.ip),o.e&&(i.e=o.e),this.onSendBeacon&&"function"==typeof this.onSendBeacon&&this.onSendBeacon(i),this.postBack({type:"beacon",data:i},r||null))},sendBeacon:function(e){e?o.bo=e:delete o.bo,o.sbc+=1,100>=o.sbc&&(this.onSendBeacon&&"function"==typeof this.onSendBeacon&&this.onSendBeacon(o),this.postBack({type:"beacon",data:o},this.onBeaconResponse||null))},heartBeat:function(){var e=this,t=1*new Date-i.initialDt;if(i.hearbeatLimit>t&&i.hbCount<i.maxHeartbeats)this.postBack({type:"heartbeat",data:{c:o.c,ua:navigator.userAgent.substr(0,150),w:o.w,dw:t}}),i.hbCount++,setTimeout(function(){e.heartBeat()},i.heartbeatInterval||3e4);else try{s.webSocket&&(s.webSocket.close(),s.webSocket=null)}catch(n){}},getSlotMeta:function(e){var t=document.getElementById("uniqueid-"+e);return t=t.dataset||{},t.tmsl=e,t},popoverEvent:function(e,t){var n=$TB.getSlotMeta(e);this.postBack({type:"beacon",data:{w:o.w,typ:c.POPOVER_EVENT,ptyp:t,doc:o.doc,c:o.c,ua:o.ua,meta:n}},this.onBeaconResponse||null)},popoverShown:function(e){$TB.popoverEvent(e,a.POPOVER_SHOWN)},popoverDismissed:function(e){$TB.popoverEvent(e,a.POPOVER_DISMISS)},popoverSubmitted:function(e,t,n,r){n=n||{},n.e=t,$TB.setData(n,r),$TB.popoverEvent(e,a.POPOVER_SUBMIT)},configure:function(){i.jQuery=window.jQuery?!0:!1,i.webSockets="WebSocket"in window&&2===window.WebSocket.CLOSING?!0:!1,"undefined"==typeof JSON&&$FR_LAB.script("//cdnjs.cloudflare.com/ajax/libs/json3/3.2.2/json3.min.js")},stripWS:function(e){try{return e?"function"==typeof e.trim?e.trim():e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):""}catch(t){return e}},stripBG:function(e){try{return e?e.replace(/\s*url\s*\(\s*["']?\s*|\s*["']?\s*\)\s*/gi,""):""}catch(t){return e}},has_own:function(e,t){try{return Object.prototype.hasOwnProperty.call(e,t)}catch(n){return!1}},doStringify:function(e){var t=this,n=function(){var e={d:[{a:[1,2]}]};try{var t=JSON.stringify(e),n=JSON.parse(t);if(n&&n.d&&"object"==typeof n.d)return!0}catch(r){}return!1};return n()?(t.doStringify=JSON.stringify,JSON.stringify(e)):(t.doStringify=function(e){var t,n,r=Array.prototype.toJSON,o=String.prototype.toJSON,i=Number.prototype.toJSON;return"undefined"!=typeof Hash&&(n=Hash.prototype.toJSON,delete Hash.prototype.toJSON),delete Array.prototype.toJSON,delete String.prototype.toJSON,delete Number.prototype.toJSON,t=JSON.stringify(e),Array.prototype.toJSON=r,String.prototype.toJSON=o,Number.prototype.toJSON=i,"undefined"!=typeof Hash&&(Hash.prototype.toJSON=n),t},t.doStringify(e))},getPageType:function(){return o.ptyp},getStore:function(){return o}};return f.configure(),f.Cookies=$FR_LAB.Cookies,f}function n(){var e=!1;if(document.getElementById("goog-gt-tt"))try{var t=document.getElementsByTagName("html")[0].className;t&&-1!==t.indexOf("translated-")&&(e=!0)}catch(n){}return e}function r(){if("undefined"==typeof JSON)return setTimeout(r,100),void 0;try{$TB.translated=n()}catch(e){}if(!$TB.translated){$TB.analyzePage();var t=!1;if(t=!1){o.skip_initial_beacon=!0;var c,s,u=$TB.getCookie("tms_db");if(u)try{u=u.split("||"),2==u.length&&(c=1*u[0],s=1*u[1])}catch(l){}var d=1*($TB.getCookie("tms_epv")||0)+1;if(!c||c>i.lBcnPInt||o.ptyp===a.CART||o.ptyp===a.CHECKOUT_THANKS){var f=1*new Date+6e4*i.lBcnMInt;$TB.setCookie("tms_db","1||"+f,new Date(f)),$TB.setCookie("tms_epv",0),$TB.sendBeacon()}else $TB.setCookie("tms_db",c+1+"||"+s,new Date(s)),$TB.setCookie("tms_epv",d);o.epv=d}if("nomail"===o.c&&o.ptyp!==a.DNT_PREFERENCE)return;$TB.translated||($TB.translated=n(),$TB.translated||(o.skip_initial_beacon?delete o.skip_initial_beacon:$TB.sendBeacon("runInitial"),setTimeout(function(){$TB.heartBeat()},i.heartbeatInterval||3e4)))}}var o={sbc:0},i={socketHost:"am.freshrelevance.com",socketProto:"https:"===location.protocol?"wss":"ws",heartbeatInterval:12e4,initialDt:1*new Date,hearbeatLimit:18e5,maxHeartbeats:15,hbCount:0,host:"//am.freshrelevance.com",formPostAction:"//am.freshrelevance.com/postForm",xPostAction:"//am.freshrelevance.com/xpost",getAction:"//am.freshrelevance.com/get",lBcnPInt:5,lBcnMInt:2,rootCookie:["www","vip","book","payment","www1"]},a={OTHER:0,PRODUCT_BROWSE:1,LOGIN:2,LOGIN_THANKS:3,REGISTER:4,REGISTER_THANKS:5,CART:6,CHECKOUT:7,CHECKOUT_THANKS:8,PRODUCT_LIST:9,ACCOUNT_EDIT:10,NEWSLETTER_EDIT:11,DNT_PREFERENCE:12,CART_INPAGE:13,POPOVER_SHOWN:17,POPOVER_DISMISS:18,POPOVER_SUBMIT:19},c={PAGE_VIEW:1,CUSTOM_SIGNAL:7,POPOVER_EVENT:11},s={};e.$TB=t();var u=function(e){"function"==typeof jQuery?jQuery(document).ready(r):"object"==typeof Prototype?document.loaded?r.call(document):document.observe("dom:loaded",r):"object"==typeof MooTools?window.addEvent("domready",r):e?setTimeout(function(){u()},250):setTimeout(r,100)};u(1)})(this);